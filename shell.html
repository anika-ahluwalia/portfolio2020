<!doctype html>

<html>
  <head>
    <title>Shell</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Bitter&family=Raleway:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="bootstrap.css">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
  </head>

  <body>
    <nav class="navbar sticky-top navbar-expand-sm navigation">
      <div class="container-fluid">
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link" href="home.html">HOME</a></li>
            <li class="nav-item"><a class="nav-link" href="about.html">ABOUT ME</a></li>
            <li class="nav-item"><a class="nav-link nav-selected" href="work.html">WORK</a></li>
            <li class="nav-item"><a class="nav-link" href="https://drive.google.com/file/d/1SezkaPqcf6_0Q4kmRg1-26kCCvG-e58D/view?usp=sharing">RESUME</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <a style="text-decoration:none" href="work.html">
        <div class="return d-flex">
            <img class="back-icon" src="assets/back-arrow.png" alt="back"/>
            <div class="accent">return to work</div>
        </div>
    </a>
    <div class="row">
        <div class="project-header col-lg-12"> Shell </div>
        <div class="project-tech col-lg-12">C | October 2020</div>
    </div>

    <div class="project-explanation-wrapper">
        <div class="section">
            <h2><span class="accent">Introduction</span></h2>
                <div class="">
                    <p>
                        For my systems engineering course, I created a shell in order to better understand 
                        computer system calls, foreground and background processes, and handling file redirection. 
                    </p>
                  <p>This project was a notable experience for me because I created this shell from scratch
                       which required a lot of problem solving and a deep level of understanding of computer systems. 
                       While I am not allowed to share the code produced in this project due to the course's collaboration policy, 
                       I would like to share some of my logic while creating it and the process of developing this project. </p>
                </div>      
          </div>

          <div class="section align-items-center justify-content-center">
            <h2><span class="accent">Parsing Input</span></h2>  
            <p>I hused the library read() function in order to parse the command line input that the user entered.
                This allowed me to read what was input into the "stdin" file descriptor into a buffer that I could 
                modify and parse through. 
                I called this function within a REPL (which was constructed by having a continuous while loop in which
                input was read in and parsed and could only be terminated by receiving a signal to do so).

                At every iteration of my REPL, I set every byte in my command-line buffer to null before reading in the input. 
                I then used the stdio.h command strtok() to tokenize the input into fragment strings and store them in a new array. 

                I had to check for various types of whitespace characters, from '\n' to ' ', and make sure that the shell still functioned even when the user input 10 tabs between arguments. ​ 
                After doing this, I check the fragment strings for redirection symbols and set them to null in my fragment strings array. I also store the files indicated before and after the redirection symbols as either the new output file or input file. I also check for multiple redirections and invalid use of redirection symbols. </p>
          </div>

          <div class="section align-items-center justify-content-center">
            <h2><span class="accent">Redirecting</span></h2>  
            <p>Ifter parsing, I check for builtin commands like "cd", "ln", and ​"rm". If none of these were used, I forked to create a child process that called the given command. Right after forking, I redirect files if necessary, which involves closing stdin or stdout and opening other files to reassign file descriptors for use when calling execv(). In my first implementation, the shell did not handle multiple processes so the shell would wait() until this foreground child process finished before moving onto the next iteration of the REPL.</p>
          </div>

          <div class="section align-items-center justify-content-center">
            <h2><span class="accent">Handling Multiple Processes</span></h2>  
            <p>To handle multiple processes, I used waitpid() instead, depending on if the forked process was foreground or background. To send a process to the background, I had to check the command line for '&' and 'bg' and made sure that the shell did not wait for the process to finish before moving on. This comes into play when reaping background processes as well. While the shell still has child processes running in the background, the process should not respond to signals like Ctrl-C but can be stopped and continued.</p>
          </div>

          <div class="section align-items-center justify-content-center">
            <h2><span class="accent">Conclusion</span></h2>  
            <p>At first, I absolutely hated this project. I was unbelievably frustrated at my lack of understanding, which was necessary for my success on the assignment. Even when running the test cases, the redirection bug caused 2 out of 99 tests to fail. However, after working at it and reviewing the lecture slides over and over again, it started to come together. ​ I'm very proud of this project because I truly learned as I wrote it. This reaffirmed to me that what isn't known can be learned. Furthermore, I created a functional shell that interacted with the computer system, something that seemed impossible a week prior. While it may be a normal project that every CS student does and as much as I hated it in the moment, this project really made me feel like I'd learned something and made me feel prepared to tackle more difficult projects in the future.</p>
          </div>
        </div>
    </div>
  </body>
</html>
